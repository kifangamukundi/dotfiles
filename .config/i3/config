set $mod Mod4

font pango:JetBrains Mono Nerd Font 8

client.focused #3a3a3a #212121 #ffffff #3a3a3a #3a3a3a
client.unfocused        #2e2e2e #1e1e1e #888888 #3a3a3a #1e1e1e
client.focused_inactive #4c4c4c #1e1e1e #cccccc #555555 #1e1e1e
client.urgent           #e07a5f #3c1f1f #ffffff #e07a5f #3c1f1f
exec --no-startup-id dex --autostart --environment i3
exec --no-startup-id nm-applet

exec_always --no-startup-id setxkbmap -option caps:escape
exec_always --no-startup-id sh -c 'echo "Default" > /tmp/i3_mode'

exec_always --no-startup-id feh --bg-scale ~/.config/i3/wallpaper.jpg
exec_always --no-startup-id ~/.config/i3/auto-workspace.py
exec_always --no-startup-id ~/.config/polybar/launch.sh
exec_always --no-startup-id picom --config ~/.config/picom/picom.conf

set $refresh_i3status killall -SIGUSR1 i3status
bindsym XF86AudioRaiseVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ +10% && $refresh_i3status
bindsym XF86AudioLowerVolume exec --no-startup-id pactl set-sink-volume @DEFAULT_SINK@ -10% && $refresh_i3status
bindsym XF86AudioMute exec --no-startup-id pactl set-sink-mute @DEFAULT_SINK@ toggle && $refresh_i3status
bindsym XF86AudioMicMute exec --no-startup-id pactl set-source-mute @DEFAULT_SOURCE@ toggle && $refresh_i3status

floating_modifier $mod
tiling_drag modifier titlebar

bindsym $mod+Return exec alacritty
bindsym $mod+d exec --no-startup-id alacritty --class AlacrittyLaunch -e bash -c "~/.local/bin/fapp | xargs -r -I{} setsid bash -c '{} >/dev/null 2>&1 &'"

for_window [class="AlacrittyLaunch"] floating enable, move position center
for_window [class="^.*"] border pixel 2

assign [class="^Alacritty$"] 1
# assign [class="org.wezfurlong.wezterm"] 2
assign [class="Google-chrome"] 3
assign [class="firefox-esr"] 4
assign [class="Vlc" window_role="vlc-video"] 5

exec --no-startup-id alacritty
# exec --no-startup-id wezterm 
exec --no-startup-id google-chrome-stable
# exec --no-startup-id firefox-esr

exec --no-startup-id i3-msg "workspace 1"

# Mode: system (reload, restart, exit)
bindsym $mod+s exec "echo 'System' > /tmp/i3_mode; i3-msg mode system"
mode "system" {
    bindsym r exec i3-msg restart
    bindsym c exec --no-startup-id bash -c 'i3-msg reload && echo Default > /tmp/i3_mode && i3-msg mode default'

    bindsym e exec --no-startup-id "i3-nagbar -t warning -m 'Exit i3?' -B 'Yes, exit i3' 'i3-msg exit && echo Default > /tmp/i3_mode && i3-msg mode default'"

    bindsym Escape exec "echo 'Default' > /tmp/i3_mode; i3-msg mode default"
}

# Mode: window
bindsym $mod+w exec "echo 'Window' > /tmp/i3_mode; i3-msg mode window"
mode "window" {
    bindsym q kill
    bindsym f exec --no-startup-id "i3-msg fullscreen toggle && echo Default > /tmp/i3_mode && i3-msg mode default"
    bindsym s layout stacking
    bindsym t layout tabbed
    bindsym e layout toggle split
    bindsym space floating toggle
    bindsym a focus parent

    bindsym h move left
    bindsym j move down
    bindsym k move up
    bindsym l move right

    bindsym Escape exec "echo 'Default' > /tmp/i3_mode; i3-msg mode default"
}

# Mode: resize
bindsym $mod+r exec "echo 'Resize' > /tmp/i3_mode; i3-msg mode resize"
mode "resize" {
    bindsym k resize grow height 10 px or 10 ppt
    bindsym j resize shrink height 10 px or 10 ppt
    bindsym l resize grow width 10 px or 10 ppt
    bindsym h resize shrink width 10 px or 10 ppt

    bindsym Left resize shrink width 10 px or 10 ppt
    bindsym Down resize grow height 10 px or 10 ppt
    bindsym Up resize shrink height 10 px or 10 ppt
    bindsym Right resize grow width 10 px or 10 ppt

    bindsym Escape exec "echo 'Default' > /tmp/i3_mode; i3-msg mode default"
}

# Mode: workspace go
bindsym $mod+g exec "echo 'Workspace' > /tmp/i3_mode; i3-msg mode workspace"
mode "workspace" {
    bindsym 1 exec --no-startup-id "i3-msg workspace number 1 && echo Default > /tmp/i3_mode && i3-msg mode default"
    bindsym 2 exec --no-startup-id "i3-msg workspace number 2 && echo Default > /tmp/i3_mode && i3-msg mode default"
    bindsym 3 exec --no-startup-id "i3-msg workspace number 3 && echo Default > /tmp/i3_mode && i3-msg mode default"
    bindsym 4 exec --no-startup-id "i3-msg workspace number 4 && echo Default > /tmp/i3_mode && i3-msg mode default"
    bindsym 5 exec --no-startup-id "i3-msg workspace number 5 && echo Default > /tmp/i3_mode && i3-msg mode default"
    bindsym 6 workspace number 6
    bindsym 7 workspace number 7
    bindsym 8 workspace number 8
    bindsym 9 workspace number 9
    bindsym 0 workspace number 10

    bindsym Escape exec "echo 'Default' > /tmp/i3_mode; i3-msg mode default"
}

# Mode: move window to workspace
bindsym $mod+m exec "echo 'Move' > /tmp/i3_mode; i3-msg mode move"
mode "move" {
    bindsym 1 exec --no-startup-id "i3-msg move container to workspace number 1 && echo Default > /tmp/i3_mode && i3-msg mode default"
    bindsym 2 exec --no-startup-id "i3-msg move container to workspace number 2 && echo Default > /tmp/i3_mode && i3-msg mode default"
    bindsym 3 exec --no-startup-id "i3-msg move container to workspace number 3 && echo Default > /tmp/i3_mode && i3-msg mode default"
    bindsym 4 exec --no-startup-id "i3-msg move container to workspace number 4 && echo Default > /tmp/i3_mode && i3-msg mode default"
    bindsym 5 exec --no-startup-id "i3-msg move container to workspace number 5 && echo Default > /tmp/i3_mode && i3-msg mode default"
    bindsym 6 move container to workspace number 6
    bindsym 7 move container to workspace number 7
    bindsym 8 move container to workspace number 8
    bindsym 9 move container to workspace number 9
    bindsym 0 move container to workspace number 10

    bindsym Escape exec "echo 'Default' > /tmp/i3_mode; i3-msg mode default"
}

bindsym $mod+p exec "echo 'Media' > /tmp/i3_mode; i3-msg mode media"
mode "media" {
    bindsym space exec --no-startup-id "playerctl --player=vlc play-pause"
    bindsym n exec --no-startup-id "playerctl --player=vlc next"
    bindsym p exec --no-startup-id "playerctl --player=vlc previous"
    bindsym i exec --no-startup-id "pactl set-sink-volume @DEFAULT_SINK@ +5%"
    bindsym d exec --no-startup-id "pactl set-sink-volume @DEFAULT_SINK@ -5%"
    bindsym m exec --no-startup-id "pactl set-sink-mute @DEFAULT_SINK@ toggle"

    bindsym s exec --no-startup-id "playerctl --player=vlc stop && echo Default > /tmp/i3_mode && i3-msg mode default"
    bindsym k exec --no-startup-id "pkill -x vlc && echo Default > /tmp/i3_mode && i3-msg mode default"
    
    bindsym Escape exec "echo 'Default' > /tmp/i3_mode; i3-msg mode default"
}

# Basic directional focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

bindsym $mod+backslash split h
bindsym $mod+minus split v
